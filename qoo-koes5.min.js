/*!
 * qoo-koes5.js
 *
 * qoo-koes5.js is a thin wrapper library for knockout-es5.
 *
 * @version 1.0.0
 * @author Hiroyuki OHARA <Hiroyuki.no22@gmail.com>
 * @copyright (c) 2014 Hiroyuki OHARA
 * @see https://github.com/no22/qoo-koes5
 * @license MIT
 */(function(e,t){typeof define=="function"&&define.amd?define(["qoo","knockout","knockout-es5"],t):t(e.qoo,e.ko)})(this,function(qoo,ko){function hasPostfix(e,t){var n=t.length;return e.length>n&&e.slice(-n)===t}function setExtenders(e,t,n,r){var i,s,o=n.length;for(s=0;s<o;s++)i=n[s],r&&r(e,i),t[i]&&t[i].extend&&(observable=ko.getObservable(e,i),observable&&observable.extend(t[i].extend))}function setSubscriber(e,t,n,r){function s(e,t){return function(n){return t.call(e,n,i)}}var i;i=t.subscribe(s(e,n),null,r)}function track(e){var t,n,r,i,s,o=e.constructor.$postfix?e.constructor.$postfix:defaultPostfix,u=o.subscriber.length,a=[],f=[],l=[],c=e.constructor.$options?e.constructor.$options:{};for(t in e)n=e[t],hasPostfix(t,o.subscriber)?l.push(t):hasPostfix(t,o.eventHandler)?typeof n=="function"&&(e[t]=function(e,t){return function(){return t.apply(e,[this].concat(Array.prototype.slice.call(arguments)))}}(e,n)):hasPostfix(t,o.property)?f.push(t):hasPostfix(t,o.observable)&&(typeof n=="function"?(c[t]&&c[t].option?e[t]=ko.computed(n,e,c[t].option):e[t]=ko.computed(n,e),c[t]&&c[t].extend&&e[t].extend(c[t].extend)):a.push(t));return ko.track(e,a),setExtenders(e,c,a),setExtenders(e,c,f,function(e,t){ko.defineProperty(e,t,e[t])}),setExtenders(e,c,l,function(e,t){var n=t.slice(0,-u),r=ko.getObservable(e,n);r&&(c[t]&&c[t].subscribe?setSubscriber(e,r,e[t],c[t].subscribe):setSubscriber(e,r,e[t]))}),e}function KnockoutEs5Options(e){return{$postfix:defaultPostfix,$options:{},_inherit_:function(t){e._inherit_.call(this,t),t.$options=qoo.extend({},this.$options),t.$postfix=qoo.extend({},this.$postfix)},koOptions:function(e){return qoo.extend(this.$options,e),this},koPostfix:function(e){return qoo.extend(this.$postfix,e),this}}}var root=this||(0,eval)("this"),$=root.jQuery?root.jQuery:null,defaultPostfix={subscriber:"Subscriber",eventHandler:"Handler",property:"$$",observable:"$"},KnockoutEs5={koinit:function(){return track(this)}},KoBase=qoo.Base.extend({constructor:function(){this.init.apply(this,arguments),this.koinit(),this.afterInit()},init:function(){},afterInit:function(){}},KnockoutEs5).classExtend(KnockoutEs5Options);return qoo.ko||(qoo.ko={}),qoo.ko.KnockoutEs5=KnockoutEs5,qoo.ko.KnockoutEs5Options=KnockoutEs5Options,qoo.ko.KoBase=KoBase,qoo.ko.track=track,!$||(qoo.ko.viewModels={},qoo.ko.vmDataAttr="kovm",qoo.ko.init=function(e,t){function r(t){return n?e.resolve(t):e[t]}e=e||root;var n=e.resolve&&typeof e.resolve=="function";return $("[data-"+qoo.ko.vmDataAttr+"]").each(function(){var e=$(this).data(qoo.ko.vmDataAttr),t=r(e),n=qoo.ko.viewModels[e]=new t;ko.applyBindings(n,this)}),t&&t(qoo.ko.viewModels),qoo.ko}),qoo.ko});